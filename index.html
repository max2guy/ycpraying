<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="연천장로교회 청년부 기도 네트워크">
    <meta name="theme-color" content="#FFF3E0">
    <title>연천장로교회 청년부: 함께 기도해요</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    
    <link rel="stylesheet" href="style.css?v=14">
    
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
</head>
<body id="body">
    <div id="loading">
        <div class="spinner"></div>
        <div class="loading-text">기도 네트워크 연결 중...</div>
    </div>

    <button class="camp-btn top-ui-common" onclick="event.stopPropagation(); toggleCampPopup()">⛺ 2026 캠프</button>
    <div class="online-counter top-ui-common">
        <div class="online-dot"></div>
        <span id="online-count">접속 중...</span>
    </div>

    <canvas id="weather-canvas"></canvas>
    <div id="visualization"></div>

    <div id="lightbox" onclick="closeLightbox()">
        <img id="lightbox-img" src="" alt="확대 이미지">
    </div>

    <div id="update-toast" class="system-toast" onclick="window.location.reload(true)">
        <div class="refresh-icon">🔄</div>
        <span>새 버전이 있습니다! (터치하여 업데이트)</span>
    </div>
    <div id="weather-toast" class="system-toast">
        <span id="weather-text">날씨 정보를 불러오는 중...</span>
    </div>

    <div id="menu-container">
        <button class="float-btn menu-main-btn" onclick="event.stopPropagation(); toggleFabMenu()">☰</button>
        <button class="float-btn sub-btn settings-btn" onclick="event.stopPropagation(); openSettingsModal()" title="설정">⚙️</button>
        <button class="float-btn sub-btn add-member-btn" onclick="event.stopPropagation(); addNewMember()" title="사람 추가">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
        </button>
    </div>

    <button class="chat-btn float-btn" onclick="event.stopPropagation(); toggleChatPopup()">
        💬
        <div id="chat-badge" class="chat-badge"></div>
    </button>
    
    <div id="settings-modal" class="popup-overlay" onclick="closeSettingsModal()">
        <div class="popup-content" style="height: auto; max-width: 320px; padding: 20px;" onclick="event.stopPropagation()">
            <div class="popup-header" style="background:transparent; border:none; padding: 0 0 15px 0;">
                <h2 style="margin:0; color:#5D4037;">설정</h2>
                <button class="close-btn" onclick="closeSettingsModal()">&times;</button>
            </div>
            <div class="settings-list">
                <div class="settings-item">
                    <div class="settings-label">🔔 앱 알림</div>
                    <label class="switch">
                        <input type="checkbox" id="setting-noti-toggle" onchange="handleNotiToggle(this)">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="settings-item">
                    <div class="settings-label">🔄 데이터 초기화</div>
                    <button class="setting-action-btn" onclick="forceRefresh()">새로고침</button>
                </div>
                <div class="settings-item">
                    <div class="settings-label">🔒 관리자 모드</div>
                    <label class="switch">
                        <input type="checkbox" id="setting-admin-toggle" onchange="handleAdminToggle(this)">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <div style="text-align:center; margin-top:20px; color:#aaa; font-size:0.8rem;">버전 1.4 (PWA)</div>
        </div>
    </div>

    <script src="script.js?v=14"></script>
</body>
</html>
